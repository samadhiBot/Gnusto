# Gnusto Auto-Wiring Plugin

Eliminate boilerplate with automatic ID generation and game setup.

## Write Games, Not Boilerplate

![Gnusto Auto-Wiring Plugin](gnusto-auto-wiring.png)

The Gnusto Interactive Fiction Engine lets you define your game world using a declarative syntax with strongly-typed IDs for compile-time safety. But declaring items and locations is only half the story. Somebody still needs to:

- Create all the strongly-typed ID constants
- Wire up items, locations, event handlers, property computers, daemons, and fuses into the game blueprint
- Keep everything up to date as game development goes on

This manual ID creation and instance wiring is tedious and error-prone. The Gnusto Auto-Wiring Plugin eliminates this burden by automatically generating all ID constants and blueprint wiring code. You focus on declaring your game world; the plugin takes care of the plumbing.

## Why Use the Auto-Wiring Plugin?

- **Zero boilerplate**: Focus on game logic, not infrastructure
- **Type safety**: Strongly-typed IDs prevent runtime errors
- **Automatic discovery**: The plugin finds and wires up all your game elements
- **Flexible structure**: Organize your code however you prefer

## What Gets Generated

The plugin scans your Swift source files and automatically generates the strongly typed IDs mentioned in your declarations, as well as the ``GameBlueprint`` extensions necessary to bring your game world together.  

### ID Extensions

When you define an ``Item``, ``Location``, ``Daemon`` or ``Fuse``, or when you mention a new and custom ``GlobalID``, the `GnustoAutoWiringPlugin` creates the appropriate identifier.

```swift
// Generated by GnustoAutoWiringPlugin
// Do not edit this file manually

import GnustoEngine

extension LocationID {
    static let aragainFalls = LocationID("aragainFalls")
    static let attic = LocationID("attic")
    ...
    static let westOfHouse = LocationID("westOfHouse")
    static let windingPassage = LocationID("windingPassage")
}

extension ItemID {
    static let advertisement = ItemID("advertisement")
    static let axe = ItemID("axe")
    ...
    static let wrench = ItemID("wrench")
    static let yellowButton = ItemID("yellowButton")
}

extension GlobalID {
    static let isBurnedOut = GlobalID("isBurnedOut")
    static let rugMoved = GlobalID("rugMoved")
    ...
    static let swordGlowLevel = GlobalID("swordGlowLevel")
    static let trapDoorBarred = GlobalID("trapDoorBarred")
}

extension DaemonID {
    static let swordDaemon = DaemonID("swordDaemon")
    static let thiefDaemon = DaemonID("thiefDaemon")
    static let trollDaemon = DaemonID("trollDaemon")
}
```

### GameBlueprint Extensions

The plugin aggregates all your game content into complete `GameBlueprint` implementations.

You can define game content in two ways:

1. Define an area as an `enum` with `static` properties, allowing you to divide the area into multiple extensions. The _Zork_ [BeneathHouse](https://github.com/samadhiBot/Gnusto/blob/main/Executables/Zork1/World/BeneathHouse.swift) area is defined this way.
2. Define an area as a `struct` with `instance` properties, allowing you to omit the `static` keyword. The _Cloak of Darkness_ [OperaHouse](https://github.com/samadhiBot/Gnusto/blob/main/Executables/CloakOfDarkness/OperaHouse.swift)

The plugin handles both ways, so use whichever feels best. You're also free to create any file hierarchy you like, as long as the world definition exists somewhere in the project folder.

```swift
extension Zork1 {
    public var items: [Item] {
        let coalMine = CoalMine()
        let thief = Thief()

        return [
            BeneathHouse.axe,
            BeneathHouse.ownersManual,
            ...
            coalMine.bat,
            thief.largeBag,
        ]
    }

    public var locations: [Location] {
        let coalMine = CoalMine()

        return [
            CyclopsHideaway.cyclopsRoom,
            CyclopsHideaway.strangePassage,
            ...
            coalMine.squeakyRoom,
            coalMine.timberRoom,
        ]
    }

    public var itemEventHandlers: [ItemID: ItemEventHandler] {
        [
            .board: GlobalItems.boardHandler,
            .boards: OutsideHouse.boardsHandler,
            ...
            .water: InsideHouse.waterHandler,
            .whiteHouse: OutsideHouse.whiteHouseHandler,
        ]
    }

    public var combatSystems: [ItemID: any CombatSystem] {
        [
            .thief: Thief.thiefCombatSystem,
        ]
    }

    public var locationEventHandlers: [LocationID: LocationEventHandler] {
        [
            .cellar: Underground.cellarHandler,
            .northClearing: Forest.northClearingHandler,
            .roundRoom: RoundRoom.roundRoomHandler,
            .trollRoom: Troll.trollRoomHandler,
        ]
    }

    public var daemons: [DaemonID: Daemon] {
        [
            .swordDaemon: InsideHouse.swordDaemon,
            .thiefDaemon: Thief.thiefDaemon,
            .trollDaemon: Troll.trollDaemon,
        ]
    }

    public var itemComputers: [ItemID: ItemComputer] {
        [
            .kitchenWindow: OutsideHouse.kitchenWindowComputer,
            .troll: Troll.trollComputer,
        ]
    }

    public var locationComputers: [LocationID: LocationComputer] {
        [
            .eastOfHouse: OutsideHouse.eastOfHouseComputer,
            .northClearing: Forest.northClearingComputer,
            .kitchen: InsideHouse.kitchenComputer,
        ]
    }
}
```

## Usage

### Adding to Your Project

Include the plugin in your `Package.swift`:

```swift
// swift-tools-version: 6.1
import PackageDescription

let package = Package(
    name: "MyGame",
    dependencies: [
        .package(url: "https://github.com/samadhiBot/Gnusto", from: "0.1.0"),
    ],
    targets: [
        .executableTarget(
            name: "MyGame",
            dependencies: ["GnustoEngine"],
            plugins: ["GnustoAutoWiringPlugin"]  // <- Add this line
        ),
    ]
)
```
